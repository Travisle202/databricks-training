The cluster extraction process in HDBSCAN focuses on identifying the most stable, persistent clusters from the complex hierarchy generated by the MST and is guided by the min_cluster_size parameter .
The process has two main phases: Condensing the Hierarchy and Extracting the Stable Clusters.
1. Condensing the Cluster Hierarchy (Pruning)
The raw dendrogram can be very complex, showing many small, insignificant splits. HDBSCAN simplifies this using the min_cluster_size parameter .
The Goal: Prune the complex hierarchy down to a simpler tree that only shows splits resulting in clusters of at least min_cluster_size .
The Process: HDBSCAN traverses the hierarchy (dendrogram) and examines every split (where a vertical line branches into two or more) .
When a cluster splits, the sizes of the resulting sub-clusters are compared against min_cluster_size .
Significant Split: If the size of both resulting sub-clusters is greater than or equal to min_cluster_size, the split is considered significant and is retained .
Insignificant Split: If one or both sub-clusters are smaller than min_cluster_size, the split is considered insignificant. The smaller sub-cluster is deemed to have "fallen out" and is labeled as noise. The larger cluster retains the identity of the parent cluster .
2. Extracting the Stable Clusters (Stability Score)
From the condensed tree, HDBSCAN selects the clusters that are considered "stable" . A stable cluster is one that persists and doesn't change much across various density levels (i.e., it has a long "lifetime" relative to its sub-clusters) .
Cluster Lifetime: On the dendrogram, the branch lengths represent the "lifetime" of a cluster before it splits or merges . HDBSCAN looks for clusters with the longest lifetimes .
Stability Score Calculation: HDBSCAN calculates a stability score for each cluster in the condensed tree . This score is the sum of the "lifetimes" of every point within that cluster .
The lifetime of a point $p$ in cluster $C$ is the range of density levels ($\lambda$ values) for which it remains a part of that specific cluster . The $\lambda$ value is calculated as $1/\text{distance}$ .
Critical $\lambda$ Values for a Point $p$ in Cluster $C$ :
$\lambda_{\text{birth}}$: The $\lambda$ value (the height on the dendrogram) at which cluster $C$ was formed (i.e., when its last two sub-components merged). This value is the same for all points within $C$ .
$\lambda_{\text{death}}$: The $\lambda$ value at which point $p$ "escapes" or "falls out of" cluster $C$ (when $C$ splits and $p$ becomes part of a smaller child). This value is specific to the point $p$ .
Individual Contribution: The stability contribution of point $p$ to cluster $C$ is: Contribution=λ 
death
​	
 −λ 
birth
​	
 
Final Selection: HDBSCAN selects the branches (clusters) with the maximum overall stability score . This ensures that the resulting clusters are robust across a range of densities, an ability that HDBSCAN has that DBSCAN struggles with .
